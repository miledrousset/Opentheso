<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <div class="row" style="margin-left: 15px; margin-right: 15px; margin-top: 5px;">
        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-4 card shadow mb-1" style="overflow:hidden; padding-right: 0rem; padding-left: 0rem">
            <h:form id="formLeftTab" >
                <p:tabView id="tabTree" activeIndex="#{leftBodySetting.index}" style="border-style: none; width: 100%;" >
                    <p:ajax event="tabChange" listener="#{tree.onTabTreeChange}" update="containerIndex:formRightTab" />
                    <div class="col-xl-2 col-lg-2 col-md-1 col-sm-1" style="overflow: auto;">
                        <p:tab id="viewTabTree">
                            <f:facet name="title">
                                <i class="pi pi-sitemap" />
                                <h:outputText value=" #{langueBean.getMsg('leftbody.concept')}"/>
                            </f:facet>
                            <ui:include src="leftBodyView/tree.xhtml"/>
                        </p:tab>
                    </div>

                    <div class="col-xl-2 col-lg-2 col-md-1 col-sm-1" style=" height: 100%">
                        <p:tab id="viewTabList">
                            <f:facet name="title">
                                <i class="pi pi-list" />
                                <h:outputText value=" #{langueBean.getMsg('leftbody.index')}"/>
                            </f:facet>
                            <ui:include src="leftBodyView/list.xhtml"/>
                        </p:tab>
                    </div>

                    <div class="col-xl-2 col-lg-2 col-md-1 col-sm-1" style=" height: 100%">
                        <p:tab id="viewTabGroups">
                            <f:facet name="title">
                                <i class="fas fa-object-group fa-1x" style="font-size: 1rem;"/>
                                <h:outputText value=" #{langueBean.getMsg('leftbody.collection')}"/>
                            </f:facet>
                            <ui:include src="leftBodyView/groups.xhtml"/>
                        </p:tab>
                    </div>

                    <div class="col-xl-2 col-lg-2 col-md-1 col-sm-1" style=" height: 100%">
                        <p:tab rendered="#{roleOnTheso.nodePreference.useConceptTree}" id="viewTabConceptTree">
                            <f:facet name="title">
                                <i class="pi pi-sitemap" />
                                <h:outputText value=" #{langueBean.getMsg('leftbody.tree')}"/>
                            </f:facet>
                            <ui:include src="leftBodyView/conceptsTree.xhtml" />
                        </p:tab>
                    </div>
                </p:tabView>

                <ui:include src="../dialog/dragAndDrop/dragAndDrop.xhtml" />
            </h:form>
        </div>

        <div class="col-xl-9 col-lg-9 col-md-9 col-sm-8">
            <div class="card shadow mb-4">
                <h:panelGroup id="formRightTab">
                    <p:tabView id="rightTab" activeIndex="#{rightBodySetting.index}" rendered="#{indexSetting.isValueSelected}"
                               style="border-style: none; height: 100%">

                        <p:ajax event="tabChange" listener="#{tree.onTabConceptChange}" update="containerIndex:formRightTab" />

                        <p:tab id="viewTabConcept" title="#{langueBean.getMsg('leftbody.concept')}" >
                            <f:facet name="anchor">
                                <i class="pi pi-sitemap" style="color: #f47b2a" size="s" />
                            </f:facet>
                            <ui:include rendered="#{rightBodySetting.showConcept}" src="rightBodyView/concept.xhtml"/>
                        </p:tab>

                        <p:tab  id="viewTabGroup" title="#{langueBean.getMsg('leftbody.collection')}" >
                            <f:facet name="anchor">
                                <i class="pi pi-sitemap" style="color: #f47b2a" size="s" />
                            </f:facet>
                            <ui:include rendered="#{rightBodySetting.showGroup}" src="rightBodyView/group.xhtml"/>
                        </p:tab>

                        <p:tab rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isManagerOnThisTheso or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}"
                               id="viewTabAlignement" title="#{langueBean.getMsg('rightbody.alignement')}" >
                            <f:facet name="anchor">
                                <i class="pi pi-sitemap" style="color: #f47b2a" size="s" />
                            </f:facet>
                            <ui:include src="rightBodyView/alignement.xhtml" />
                        </p:tab>

                        <p:tab rendered="#{roleOnTheso.nodePreference.suggestion}" disabled="#{!propositionBean.isRubriqueVisible}" title="#{langueBean.getMsg('rightbody.newSuggest')}" >
                            <f:facet name="anchor">
                                <i class="pi pi-sitemap" style="color: #f47b2a" size="s" />
                            </f:facet>
                            <ui:include src="rightBodyView/proposition/nouvelleProposition.xhtml"/>
                        </p:tab>
                    </p:tabView>

                    <h:panelGroup rendered="#{indexSetting.isFacetSelected}">
                        <ui:include src="rightBodyView/facet.xhtml" />
                    </h:panelGroup>

                    <h:panelGroup rendered="#{indexSetting.isHomeSelected}" >
                        <ui:include src="rightBodyView/thesoHome.xhtml" />
                    </h:panelGroup>
                </h:panelGroup>
            </div>
        </div>
    </div>

    <ui:include src="../dialog/concept/addTopConcept.xhtml" />

    <ui:include src="../dialog/group/addGroup.xhtml" />
    <ui:include src="../dialog/group/addSubGroup.xhtml" />
    <ui:include src="../dialog/group/deleteGroup.xhtml" />
    <ui:include src="../dialog/group/modifyGroup.xhtml" />    
    <ui:include src="../dialog/group/addTraductionGroup.xhtml" />
    <ui:include src="../dialog/group/deleteTraductionGroup.xhtml" />
    <ui:include src="../dialog/group/renameTraductionGroup.xhtml" />    
    <ui:include src="../dialog/group/generateArkGroup.xhtml" />        

    <ui:include src="../dialog/alignment/addAlignmentDialog.xhtml" />
    <ui:include src="../dialog/alignment/updateSingleAlignment.xhtml" />

    <!-- déplacements des dialogs #MR --> 
    <ui:include src="../dialog/concept/renameConcept.xhtml" />    
    <ui:include src="../dialog/concept/addNT.xhtml" /> 

    <ui:include src="../dialog/synonym/addSynonym.xhtml" />
    <ui:include src="../dialog/synonym/renameSynonym.xhtml" />
    <ui:include src="../dialog/synonym/deleteSynonym.xhtml" />

    <ui:include src="../dialog/facet/addFacet.xhtml" />   
    <ui:include src="../dialog/facet/renameFacet.xhtml" />

    <ui:include src="../dialog/facet/addFacetTraduction.xhtml" /> 
    <ui:include src="../dialog/facet/renameFacetTraduction.xhtml" />   
    <ui:include src="../dialog/facet/deleteFacetTraduction.xhtml" />

    <ui:include src="../dialog/facet/addConceptParentToFacet.xhtml" />

    <ui:include src="../dialog/facet/addNT.xhtml" />
    <ui:include src="../dialog/facet/addMembers.xhtml" />
    <ui:include src="../dialog/facet/removeMembers.xhtml" />

    <ui:include src="../dialog/concept/replaceBy.xhtml" />
    <ui:include src="../dialog/concept/deleteReplaceBy.xhtml" />    

    <ui:include src="../dialog/traduction/addTraduction.xhtml" />    
    <ui:include src="../dialog/traduction/renameTraduction.xhtml" />
    <ui:include src="../dialog/traduction/deleteTraduction.xhtml" />

    <ui:include src="../dialog/note/addNote.xhtml" />   
    <ui:include src="../dialog/note/editNote.xhtml" /> 
    <ui:include src="../dialog/note/deleteNote.xhtml" />     

    <ui:include src="../dialog/externalResources/addExternalResource.xhtml" /> 
    <ui:include src="../dialog/externalResources/deleteExternalResource.xhtml" />    
    <ui:include src="../dialog/externalResources/updateExternalResource.xhtml" />      

    <ui:include src="../dialog/facet/addConceptToFacet.xhtml" />    
    <ui:include src="../dialog/facet/removeConceptFromFracets.xhtml" />

    <ui:include src="../dialog/group/addConceptToGroup.xhtml" />
    <ui:include src="../dialog/group/removeConceptFromGroup.xhtml" />
    <ui:include src="../dialog/group/addConceptAndChildToGroup.xhtml" />
    <ui:include src="../dialog/group/removeConceptAndChildFromGroup.xhtml" />

    <ui:include src="../dialog/broader/addBroaderLink.xhtml" />
    <ui:include src="../dialog/broader/deleteBroaderLink.xhtml" />

    <ui:include src="../dialog/narrower/addNarrowerLink.xhtml" />
    <ui:include src="../dialog/narrower/changeRelation.xhtml" />
    <ui:include src="../dialog/narrower/deleteNarrowerLink.xhtml" />

    <ui:include src="../dialog/related/deleteRelatedLink.xhtml" />
    <ui:include src="../dialog/related/addRelatedLink.xhtml" />

    <ui:include src="../dialog/concept/setNotation.xhtml" />

    <ui:include src="../dialog/alignment/addManualAlignment.xhtml" />
    <ui:include src="../dialog/alignment/deleteAlignment.xhtml" />
    <ui:include src="../dialog/alignment/updateAlignment.xhtml" />

    <ui:include src="../dialog/image/addImage.xhtml" />
    <ui:include src="../dialog/image/updateImage.xhtml" />
    <ui:include src="../dialog/image/deleteImage.xhtml" />

    <ui:include src="../dialog/gps/setGps.xhtml" />
    <ui:include src="../dialog/gps/deleteGps.xhtml" />

    <ui:include src="../dialog/concept/deleteConcept.xhtml" />
    <ui:include src="../dialog/concept/deprecateConcept.xhtml" />






    <p:dialog id="idDragAndDropGroupe" header="Drag and Drop control" widgetVar="dragAndDropGroupe" 
              modal="true" resizable="true" closable="false" position="top" width="500" style="margin-top: 50px" >

        <h:form id="dragAndDropFormGroupe">

            <div class="row" style="font-size: 14px; color: black">
                <div class="col-5" style="margin-left: 10px;">
                    <h:outputText value="Déplacer le concept/branche: " title="terme à couper"/>
                </div>           
                <div class="col-6" >
                    <i class="pi pi-cut" style="color: red; margin-right: 20px;"/>
                    <h:outputText value="  #{dragAndDrop.cuttedConcept.term.lexical_value} (#{dragAndDrop.cuttedConcept.concept.idConcept})  "
                                  title="terme à couper" style="background-color: #C63632; color: #ffffff"/>
                </div>                   
            </div>

            <div class="row" style="font-size: 14px; color: black">
                <div class="col-5" style="margin-left: 10px;">
                    <h:outputText value="vers le concept : " title="Vers ce concept" />
                </div>                  
                <div class="col-6">
                    <i class="pi pi-arrow-right" style="color: green; margin-right: 20px;"/>
                    <h:outputText value=" #{dragAndDrop.dropppedConcept.term.lexical_value} (#{dragAndDrop.dropppedConcept.concept.idConcept})" 
                                  title="Vers ce concept" style="background-color: #54a90a; color: #ffffff"/>
                </div>                  
            </div>            

            <h:panelGroup rendered="#{dragAndDrop.nodeBTsToCut.size() > 0}" style="margin-top: 30px"> 
                <div class="card mb-4 py-3 border-left-success" style="border-color: #43B572; margin-top: 10px">
                    <p:dataTable size="small" value="#{dragAndDrop.nodeBTsToCut}" var="broader"
                                 widgetVar="nodeBTsToCut" styleClass="products-table"
                                 style="margin-bottom: -17px; margin-top: -16px;">

                        <f:facet name="header">
                            <div class="products-table-header">
                                <span style="font-weight: bold">
                                    <h:outputText value="Poly-hiérarchie à supprimer / garder ? : " 
                                                  title="Cochez la case pour supprimer la relation"/>
                                </span>
                            </div>
                        </f:facet>

                        <p:column headerText="id" width="100">
                            <h:outputText value="#{broader.idConcept}" />
                        </p:column>                        
                        <p:column headerText="Terme générique">
                            <h:outputText value="#{broader.title}" />
                        </p:column>
                        <p:column headerText="à couper" width="80">
                            <p:selectBooleanCheckbox value="#{broader.isSelected}" />
                        </p:column>
                    </p:dataTable>
                </div>
            </h:panelGroup>           

            <h:panelGroup rendered="#{dragAndDrop.nodeGroupsToCut.size() > 0}" style="margin-top: 30px"> 
                <div class="card mb-4 py-3 border-left-success" style="border-color: #43B572; margin-top: 10px">
                    <p:dataTable size="small" value="#{dragAndDrop.nodeGroupsToCut}" var="group"
                                 widgetVar="nodeGroupsToCut" styleClass="products-table"
                                 style="margin-bottom: -17px; margin-top: -16px;">

                        <f:facet name="header">
                            <div class="products-table-header">
                                <span style="font-weight: bold">
                                    <h:outputText value="Collections à supprimer ? " 
                                                  title="Cochez la case pour supprimer la relation"/>
                                </span>
                            </div>
                        </f:facet>

                        <p:column headerText="id" width="100">
                            <h:outputText value="#{group.conceptGroup.idgroup}" />
                        </p:column>                        
                        <p:column headerText="Collection/groupe">
                            <h:outputText value="#{group.lexicalValue}"/>
                        </p:column>
                        <p:column headerText="à supprimer" width="80">
                            <p:selectBooleanCheckbox value="#{group.isSelected}" />
                        </p:column>
                    </p:dataTable>
                </div>
            </h:panelGroup>        

            <h:panelGroup rendered="#{dragAndDrop.nodeGroupsToAdd.size() > 0}" style="margin-top: 30px"> 
                <div class="card mb-4 py-3 border-left-success" style="border-color: #43B572; margin-top: 10px">
                    <p:dataTable size="small" value="#{dragAndDrop.nodeGroupsToAdd}" var="group"
                                 widgetVar="nodeGroupsToAdd" styleClass="products-table"
                                 style="margin-bottom: -17px; margin-top: -16px;">

                        <f:facet name="header">
                            <div class="products-table-header">
                                <span style="font-weight: bold">
                                    <h:outputText value="Collections à ajouter ? " title="Cochez la case pour ajouter la relation"/>
                                </span>
                            </div>
                        </f:facet>

                        <p:column headerText="id" width="100">
                            <h:outputText value="#{broader.idConcept}" />
                        </p:column>                        
                        <p:column headerText="Terme générique">
                            <h:outputText value="#{broader.title}" />
                        </p:column>
                        <p:column headerText="à couper" width="80">
                            <p:selectBooleanCheckbox value="#{broader.isSelected}" />
                        </p:column>
                    </p:dataTable>
                </div>
            </h:panelGroup>

            <div style="width: 100%; text-align: right; margin-top: 15px; margin-bottom: 5px;">
                <p:commandButton value="#{langueBean.getMsg('btnCancel')}" 
                                 icon="fas fa-undo-alt" styleClass="ui-button-secondary button" 
                                 style="margin-right: 10px"
                                 oncomplete="PF('dragAndDrop').hide();"
                                 actionListener="#{dragAndDrop.rollBackAfterErrorOrCancelDragDrop()}" 
                                 update="containerIndex messageIndex" 
                                 process="@this" ajax="true"/>

                <p:commandButton value="#{langueBean.getMsg('btnValidate')}" 
                                 update="containerIndex messageIndex"
                                 icon="pi pi-check" 
                                 styleClass="ui-button-success"
                                 oncomplete="PF('dragAndDrop').hide();"
                                 actionListener="#{dragAndDrop.drop()}" 
                                 process="@this" ajax="true"/>
            </div>
        </h:form>
    </p:dialog>
</ui:composition>