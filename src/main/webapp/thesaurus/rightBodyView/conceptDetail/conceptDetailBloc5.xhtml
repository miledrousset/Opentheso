<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://java.sun.com/jsf/html"  
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:p="http://primefaces.org/ui"
             xmlns:leaf="http://java.sun.com/jsf/composite/jsf2leaf">

    <div class="card mb-4 py-3 border-left-success">
        <div class="card-body">
            <div class="container">

                <!-- ligne Corpus liés -->  
                <div class="row">
                    <div class="col-2">
                        <i class="pi pi-angle-double-right" />

                        <h:outputText value=" #{langueBean.getMsg('rightbody.concept.linked_corpus')} : " 
                                      title="#{langueBean.getMsg('rightbody.concept.linked_corpus')}"
                                      style="font-size: 14px; font-weight: bold;"/>
                    </div>

                    <div class="col-1">
                        <p:commandButton rendered="#{user.nodeUser != null}" icon="fas fa-cog fa-xs" 
                                         style="color:#F7A269; background: none; border: none; box-shadow: none" />
                    </div>

                    <div class= "col-9">
                        <h:panelGroup rendered="#{(corpus.count != 0 and corpus.count!= -1) or (corpus.isOnlyUriLink)}">
                            <ui:repeat var="corpus" value="#{conceptView.nodeCorpuses}" >
                                <div class="row">
                                    <div class="col-6">
                                        <p:link href="#{corpus.uriLink}"
                                                value="#{corpus.corpusName} (#{corpus.count} #{langueBean.getMsg('rightbody.concept.notices')})"
                                                target="_blank" style="font-size: 12px; color: #43B572;">
                                            <i class="pi pi-link" />
                                        </p:link>
                                    </div>
                                    <div class="col-6">
                                        <p:link href="#{corpus.uriLink}" value="#{corpus.corpusName}" target="_blank"
                                                style="font-size: 12px; color: #43B572;">
                                            <i class="pi pi-link" />
                                        </p:link>
                                    </div>
                                </div>
                            </ui:repeat>
                        </h:panelGroup> 
                    </div>
                </div>

                <!-- ligne Alignements -->
                <h:panelGroup rendered="#{(currentUser.nodeUser != null) or (conceptView.nodeConcept.nodeAlignments.size() != 0)}">
                    <div class="row">
                        <div class="col-2">
                            <i class="pi pi-angle-double-right" />

                            <h:outputText value=" #{langueBean.getMsg('rightbody.concept.alignment')} : " 
                                          title="#{langueBean.getMsg('rightbody.concept.alignment')}"
                                          style="font-size: 14px; font-weight: bold;"/>
                        </div>

                        <div class="col-1">
                            <p:menuButton rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isManagerOnThisTheso or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}"
                                          icon="pi pi-cog"
                                          style="color: #F7A269; background: none; border: none; box-shadow: none; font-size: 12px;">
                                <p:menuitem value="#{langueBean.getMsg('rightbody.concept.add_alignment_auto')}" 
                                            actionListener="#{alignmentBean.initAlignementByStep(
                                                              selectedTheso.currentIdTheso, 
                                                              conceptView.nodeConcept.concept.idConcept,
                                                              conceptView.selectedLang)}"
                                            action="#{alignmentBean.nextTen(conceptView.selectedLang, selectedTheso.currentIdTheso)}"                                      
                                            oncomplete="PF('addAlignment').show();"
                                            style="font-size: 12px;" />

                                <p:menuitem value="#{langueBean.getMsg('rightbody.concept.add_alignment_manual')}" 
                                            actionListener="#{alignmentManualBean.reset()}"
                                            oncomplete="PF('addManualAlignment').show();"
                                            style="font-size: 12px;" />                                      

                                <p:menuitem value="#{langueBean.getMsg('rightbody.concept.edit_alignment')}" 
                                            action="#{alignmentManualBean.reset()}"                                      
                                            oncomplete="PF('updateAlignment').show();"
                                            style="font-size: 12px;" />

                                <p:menuitem value="#{langueBean.getMsg('rightbody.concept.delete_alignment')}" 
                                            actionListener="#{alignmentBean.initAlignementByStep(
                                                              selectedTheso.currentIdTheso, 
                                                              conceptView.nodeConcept.concept.idConcept,
                                                              conceptView.selectedLang)}"
                                            action="#{alignmentManualBean.reset()}"                                      
                                            oncomplete="PF('deleteAlignment').show();"
                                            style="font-size: 12px;" />                                        
                            </p:menuButton> 
                        </div>

                        <h:panelGroup rendered="#{conceptView.nodeConcept.nodeAlignments.size() == 0}">
                            <div class="col-9">
                                <h:outputText  value="....." title="#{langueBean.getMsg('rightbody.concept.no_value')}" style="font-size: 12px; color: grey; font-style: italic " />
                            </div>
                        </h:panelGroup>

                        <h:panelGroup rendered="#{conceptView.nodeConcept.nodeAlignments.size() != 0}">
                            <div class="col-9">
                                <ui:repeat var="align" value="#{conceptView.nodeConcept.nodeAlignments}" >
                                    <div class="row">
                                        <div class="col-3">
                                            <h:outputText value="#{align.alignmentLabelType}:" />
                                        </div>
                                        <div class="col-9">
                                            <p:link href="#{align.uri_target}"
                                                    value="#{align.uri_target}"
                                                    target="_blank" style="font-size: 12px; color: #43B572;" >
                                                <i class="pi pi-link" />
                                            </p:link>
                                            <h:outputText value=" (#{align.thesaurus_target})"  style="font-size: 12px;"/>
                                        </div>
                                    </div> 
                                </ui:repeat>
                            </div>
                        </h:panelGroup>
                    </div>
                </h:panelGroup>


                <!-- Notation -->
                <h:panelGroup rendered="#{(currentUser.nodeUser != null) or (conceptView.nodeConcept.concept.notation != '')}">
                    <div class="row">
                        <div class="col-2">
                            <i class="pi pi-angle-double-right" />

                            <h:outputText value=" #{langueBean.getMsg('rightbody.concept.notation')} : " 
                                          title="#{langueBean.getMsg('rightbody.concept.notation')}"
                                          style="font-size: 14px; font-weight: bold;"/>
                        </div>

                        <div class="col-1">
                            <p:menuButton rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isManagerOnThisTheso or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}"
                                          icon="pi pi-cog" style="color: #F7A269; background: none; border: none; box-shadow: none; font-size: 12px;">
                                <p:menuitem value="#{langueBean.getMsg('rightbody.concept.add_edit_notation')}" 
                                               action="#{notationBean.reset()}"
                                               oncomplete="PF('setNotation').show();"
                                               style="font-size: 12px;" />
                            </p:menuButton> 
                        </div>

                        <h:panelGroup rendered="#{(conceptView.nodeConcept.concept.notation == null) or (conceptView.nodeConcept.concept.notation == '') }">
                            <div class="col-9">
                                <h:outputText  value="....." title="#{langueBean.getMsg('rightbody.concept.no_value')}" style="font-size: 12px; color: grey; font-style: italic " />
                            </div>
                        </h:panelGroup>

                        <h:panelGroup rendered="#{(conceptView.nodeConcept.concept.notation != null) and (conceptView.nodeConcept.concept.notation != '') }">
                            <div class="col-9">
                                <h:outputText value="#{conceptView.nodeConcept.concept.notation}" style="font-size: 12px; color: #666666"/>
                            </div>
                        </h:panelGroup>
                    </div>
                </h:panelGroup>

                <div class="row">
                    <div class="col-4">
                        <h:outputText value="#{langueBean.getMsg('rightbody.concept.internal_id')}" style="margin-left: 5px;"/>
                    </div>
                    <div class="col-8">
                        <p:link href="#{request.contextPath}/?idc=#{conceptView.nodeConcept.concept.idConcept}&amp;idt=#{conceptView.nodeConcept.concept.idThesaurus}"
                                value="#{conceptView.nodeConcept.concept.idConcept}" style="font-size: 12px; color: #43B572;">
                            <i class="pi pi-link" />
                        </p:link>
                    </div>
                </div >


                <!--Panel de séparation des identifiants pérennes permet de les masquer-->
                <!--<<h:panelGroup rendered="# {conceptView.nodeConcept.concept.idConcept == 'ddd'}"> -->
                <h:panelGroup>
                    <div class="row">
                        <div class="col-4">
                            <h:outputText value="#{langueBean.getMsg('rightbody.concept.original_uri')}" style="margin-left: 5px;"/>
                        </div>

                        <!-- Cas d'uri de type Ark -->
                        <h:panelGroup rendered="#{roleOnTheso.nodePreference.originalUriIsArk}">
                            <div class="col-8">
                                <p:link href="#{roleOnTheso.nodePreference.originalUri}/#{conceptView.nodeConcept.concept.idArk}"
                                        value="#{roleOnTheso.nodePreference.originalUri}/#{conceptView.nodeConcept.concept.idArk}" style="font-size: 12px; color: #43B572;">
                                    <i class="pi pi-link" />
                                </p:link>
                            </div>
                        </h:panelGroup>

                        <!-- Cas d'uri de type Handle -->
                        <h:panelGroup rendered="#{roleOnTheso.nodePreference.originalUriIsHandle}">
                            <div class="col-8">
                                <p:link href="#{roleOnTheso.nodePreference.originalUri}/#{conceptView.nodeConcept.concept.idHandle}"
                                        value="#{roleOnTheso.nodePreference.originalUri}/#{conceptView.nodeConcept.concept.idHandle}" style="font-size: 12px; color: #43B572;">
                                    <i class="pi pi-link" />
                                </p:link>
                            </div>
                        </h:panelGroup>

                        <!-- Cas d'uri de type Doi -->
                        <h:panelGroup rendered="#{roleOnTheso.nodePreference.originalUriIsDoi}">
                            <div class="col-8">
                                <p:link href="#{roleOnTheso.nodePreference.originalUri}/#{conceptView.nodeConcept.concept.idDoi}"
                                        value="#{roleOnTheso.nodePreference.originalUri}/#{conceptView.nodeConcept.concept.idDoi}" 
                                        style="font-size: 12px; color: #43B572;">
                                    <i class="pi pi-link" />
                                </p:link>
                            </div>
                        </h:panelGroup>

                        <!-- Cas d'uri de type Doi -->
                        <h:panelGroup rendered="#{conceptView.nodeConcept.concept.idArk != ''}">
                            <div class="col-4">
                                <h:outputText value="IdArk" style="margin-left: 5px;"/>
                            </div>
                            <div class="col-6">
                                <h:outputText value="#{conceptView.nodeConcept.concept.idArk}" style="font-size: 12px; color: #43B572;"/>
                            </div>
                        </h:panelGroup>
                    </div>

                    <div class="row">
                        <div class="col-10">
                            <h:panelGroup rendered="#{conceptView.nodeConcept.concept.idHandle != ''}">
                                <div class="row">
                                    <div class="col-4">
                                        <h:outputText value="IdHandle" style="margin-left: 5px;"/>
                                    </div>
                                    <div class="col-8">
                                        <h:outputText value="#{conceptView.nodeConcept.concept.idHandle}" style="font-size: 12px; color: #43B572;"/>
                                    </div>
                                </div>  
                            </h:panelGroup>
                        </div>
                        <h:panelGroup rendered="#{conceptView.nodeConcept.concept.idArk != ''}">
                            <div class="col-2">
                                <p:barcode value="#{roleOnTheso.nodePreference.originalUri}/#{conceptView.nodeConcept.concept.idArk}" type="qr" height="75px;"/>
                            </div>
                        </h:panelGroup>
                    </div>
                </h:panelGroup>


                <!-- ligne dates -->        
                <div class="row">  
                    <div class="col-12" style="font-size: 12px; color: grey; font-style: italic ">
                        <h:outputText value="#{langueBean.getMsg('rightbody.concept.created')}: " />
                        <h:outputText value="#{conceptView.nodeConcept.concept.created}" style="color: #43B572"/>
                        <h:outputText value=" #{langueBean.getMsg('rightbody.concept.last_modification')}: "/>
                        <h:outputText value="#{conceptView.nodeConcept.concept.modified}" style="color: #43B572"/>
                        <p:commandButton rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isManagerOnThisTheso or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}"
                                         icon="fa fa-history"
                                         actionListener="#{historyBean.reset()}"
                                         oncomplete="PF('historicalView').show();"
                                         title="#{langueBean.getMsg('rightbody.concept.view_change_history')}"
                                         style=" font-size: 14px"
                                         styleClass="buttonIconOrange"/>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <h:outputText value="#{langueBean.getMsg('rightbody.concept.createdBy')} : " style="color: #666666"/>
                        <h:outputText value="#{conceptView.creator}" style="color: #43B572"/>
                    </div>
                    <div class="col-12">
                        <h:outputText value="#{langueBean.getMsg('rightbody.concept.last_modificationBy')} : " style="color: #666666"/>
                        <h:outputText value="#{conceptView.contributor}" style="color: #43B572"/>
                    </div>
                </div>
            </div>
        </div>
    </div>

</ui:fragment>